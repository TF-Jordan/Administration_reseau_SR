{
  "name": "Slow API Response Alert",
  "tags": ["performance", "api", "latency"],
  "rule_type_id": ".es-query",
  "params": {
    "index": ["recommendation-api-logs-*"],
    "timeField": "timestamp",
    "esQuery": "{\"query\":{\"bool\":{\"must\":[{\"range\":{\"timestamp\":{\"gte\":\"now-5m\"}}},{\"term\":{\"event\":\"request_completed\"}},{\"range\":{\"duration_ms\":{\"gte\":2000}}}]}}}",
    "threshold": [5],
    "thresholdComparator": ">",
    "timeWindowSize": 5,
    "timeWindowUnit": "m"
  },
  "consumer": "alerts",
  "schedule": {
    "interval": "5m"
  },
  "enabled": true,
  "actions": [
    {
      "id": "log_action",
      "group": "default",
      "params": {
        "level": "warn",
        "message": "Slow API responses detected: {{context.hits}} requests took >2s in last 5 minutes"
      }
    }
  ],
  "notify_when": "onActionGroupChange",
  "throttle": "15m"
}
